function getParseHtml(textoHTML){
		//Subsistui a formação
		textoHTML = textoHTML.replace(/<\/?s:/g,"<s");
		textoHTML = textoHTML.replace(/<\/?t:/g,"<t");
		textoHTML = textoHTML.replace(/<\/?m:/g,"<m");
		textoHTML = textoHTML.replace(/<\/?h:/g,"<h");
		
		if (window.DOMParser){
			var parser=new DOMParser();
			console.log(textoHTML);
			var xmlDoc=parser.parseFromString(textoHTML,"text/xml");			
		}else{
			var xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
			xmlDoc.async=false;
			xmlDoc.loadXML(textoHTML); 
		}
		//Pega body do e-mail
		var body = xmlDoc.getElementsByTagName("tBody")[0].childNodes[0].nodeValue;
		//Pega a lista de anexo
		var attachments = xmlDoc.getElementsByTagName("tFileAttachment");
		
		//Insere as imagens nos anexos
		var name, imgid, re;
		for(var i = 0; i < attachments.length; i++){
			if(attachments[i].getElementsByTagName("tAttachmentId")[0] == undefined) continue;	
			
			iName = attachments[i].getElementsByTagName("tContentId")[0].childNodes[0].nodeValue;
			nName = attachments[i].getElementsByTagName("tName")[0].childNodes[0].nodeValue;
			imgid = attachments[i].getElementsByTagName("tAttachmentId")[0].attributes.getNamedItem("Id").nodeValue;
			
			re = new RegExp('cid:'+nName+'.{18}', 'g');
			body = body.replace(re, 'https://outlook.office365.com/owa/service.svc/s/GetFileAttachment?id='+encodeURIComponent(imgid)+'&X-OWA-CANARY='+getCookie('CANARY'));
			
			re = new RegExp('cid:'+iName, 'g');
			body = body.replace(re, 'https://outlook.office365.com/owa/service.svc/s/GetFileAttachment?id='+encodeURIComponent(imgid)+'&X-OWA-CANARY='+getCookie('CANARY'));
		}
		
		return body;
	}
